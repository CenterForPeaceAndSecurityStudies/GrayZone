---
title: "07_FullData"
author: J Andres Gannon, Erik Gartzke, and Jon Lindsay, Center for Peace and Security
  Studies (cPASS)
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
    toc_depth: '5'
  html_notebook:
    fig_height: 8
    fig_width: 12
    number_sections: yes
    theme: flatly
    toc: yes
    toc_depth: 5
    toc_float:
      collapsed: yes
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '5'
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This document compares case and variable coverage across all the Russia cyber data investigated.

The data comes from the following sources:

ICB comes from Brecher, Michael and Jonathan Wilkenfeld (2000). A Study of Crisis. Ann Arbor: University of Michigan Press.

DCID comes from Valeriano, B., & Maness, R. C. (2014). The dynamics of cyber conflict between rival antagonists, 2001–11. Journal of Peace Research, 51(3), 347–360. https://doi.org/10.1177/0022343313518940

REI comes from Casey, Adam; Way, Lucan Ahmad, 2017, "Russian Electoral Interventions, 1991-2017", https://doi.org/10.5683/SP/BYRQQS, Scholars Portal Dataverse

# Preparation
## Load packages
Pipe operators have trouble loading for individual commands
```{r}
library(magrittr)
library(ggplot2)
```

## Load data
Load the cleaned and subset versions of each dataset
```{r}
# Load data
cpass <- readRDS(paste0(here::here(), '/data/grayzone_cpass.rds'))
icb <- readRDS(paste0(here::here(), '/data/grayzone_icb.rds'))
dcid <- readRDS(paste0(here::here(), '/data/grayzone_dcid.rds'))
rei <- readRDS(paste0(here::here(), '/data/grayzone_rei.rds'))
```

# Compare coverage
Before merging the data, compare the different cases covered by each one
```{r}
# Create identifier variables for each dataset
cpass$cpass <- 1
icb$icb <- 1
dcid$dcid <- 1
rei$rei <- 1

# Ensure proper unit of analysis
summary(cpass)
summary(icb)

# Rename variables so they are the same across the datasets
rei <- rei %>% dplyr::rename('Year' = year,
                             'Target' = target_state,
                             'Target COW code' = target_ccode,
                             'Target Event' = target_event,
                             'Start Date' = event_sdate,
                             'End Date' = event_edate,
                             'Pro-incumbent' = pro_incumbent,
                             'Disinformation campaign' = disinfo,
                             'Coup attempt' = coup,
                             'Cyberattack' = cyberattack,
                             'Material support' = mat_support,
                             'Outcome' = outcome,
                             'Favorable outcome' = outcome_favorable,
                             'Evidence of impact' = rus_impact)

```

# Merge data
First we identify the variables in each dataset and which are duplicates

# Summary statistics
```{r}
names(rei)

```

## Summary
Make a table summarizing the data on Russian crisis participation
```{r}
formattable::formattable(rei,
                         align = c("c", "l", "l", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c"),
                         list('Pro-incumbent' = formattable::color_tile("transparent", "red"),
                              'Disinformation campaign' = formattable::color_tile("transparent", "red"),
                              'Coup attempt' = formattable::color_tile("transparent", "red"),
                              'Cyberattack' = formattable::color_tile("transparent", "red"),
                              'Material support' = formattable::color_tile("transparent", "red"),
                              'Favorable outcome' = formattable::color_tile("transparent", "lightblue"),
                              'Evidence of impact' = formattable::color_tile("transparent", "lightblue")))
```

## Plots
Given the number of cases, summarize them in plot format.
```{r}
DataExplorer::plot_bar(rei)
```

# Save final dataframe
```{r}
saveRDS(rei, paste0(here::here(), "/data/","grayzone_rei.rds"))
```
